# Heaven Door Editor 剧情编辑器
## HDEditor所提供的功能
- 剧情分支，选项
- 查看历史记录，200条
- 文字着色
- 语速功能，调整文字出现的时间和打字机音效的速度
- 立绘位置可视化调整
- 文字控制符
- 快进已读文本



## 底层Json设计

### 为什么使用Json
- 足够简单，可读性好
- 易于修改，相比XML复杂的读写，Json的读写会自由得多
- 社区对于Json的支持比较好

### 层次

初步的想法是分成两类（或者更多类）的节点，通过串连节点来提供足够的灵活性。

一个节点就是一个数据结构的实例，用json的格式储存，每种节点都有一个节点类型用来指明应该如何使用该节点，包含大量的参数用来显示节点。

### 剧情文本节点
第一类是普通的剧情文本节点，包括：

name，名字，对话者的姓名，可缺省，如果缺省则不会在播放时显示名字框。

content，内容，对话的具体内容，在内容中可以添加控制符号，目前首先实现策划案中提到的GM使用的控制符，如果反斜杠不够用的话，可以用HTML的成对尖括号来表现。

tachie，立绘，可缺省，既不显示任何立绘

tachiePos，立绘位置，两个，三个人和五个人的立绘位置都是不同的，提供一个配置表，可以指定变量，也可以直接指定百分比。

### 剧情文本控制符

![avatar](./HeavenDoor_img_1.png)
<sub>这个是逸凡提到的GM控制符号，显示文字时的等待时间，我希望能够提供一个config表用来给定几个不同的间隔时间变量</sub>

立绘，vfx不和剧情的文本内容放在同一个类型中，他们应该是一系列控制符号可以调用的变量。因为可能会出现一个对话当中出现多次停顿，每次都会切换立绘和播放音效。

expression，表情控制符，需要一个config表用来配置不同的立绘和表情，可以让他们形成一种映射，一个变量对应一系列表情和口型参数，这边需要为未来的眼睛动作和口型动作做好准备。（天知道最后会提出什么需求）

<sub>[实现参考](http://tranpol.weebly.com/2821625103314353247230340210462031620840368073124365288305043052421160214752241122797264342925665289.html)</sub>

color，切换颜色

spped，切换语速

music，切换音乐

vfx，音效，控制效果音

### 行为控制节点

第二类为行为控制节点，包括转场，跳转，分支等各种对话模式的具体实现细节

转场节点Transition

## 编辑器功能

### 导入，导出文本
在编辑器的最初版本正式可用之前，我们需要一个导入机制

### 撤销，复制，剪切和黏贴
加把劲，gkd


